SELECT 
     	CASE F2_FILIAL
    		WHEN '01' THEN 'CNPJ01'
    	 	ELSE NULL
  		 END AS CNPJORIGEMDADOS,
      CONCAT (E1_FILIAL, E1_FILORIG, E1_NUM, E1_SERIE, E1_PARCELA, E1_CLIENTE, E1_LOJA, E1_EMISSAO) ID,
      CONCAT (E1_NUM, E1_PARCELA) TITULO,
      CONCAT (E1_CLIENTE, E1_LOJA) IDCLIENTE,
      A1_NOME,
      E1_EMISSAO,
      E1_NUM,
      E1_SERIE,
      E1_VENCORI,
      E1_VENCREA,
      E1_VALOR,
      E1_JUROS,
      E1_DESCONT,
      E1_VALLIQ,
      E1_PARCELA,
      E1_STATUS,
      E1_BAIXA,
      E1_VEND1,
      E1_VEND2,
      E1_VEND3,
      E1_VEND4,
      B.D_E_L_E_T_ DELETADO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.E1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.E1_USERLGI, 16, 1)) - 50)), '19960101'), 103) AS DATA_INCLUSAO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.E1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.E1_USERLGA, 16, 1)) - 50)), '19960101'), 103) AS DATA_ALTERACAO
FROM SE1010 B WITH (NOLOCK)
INNER JOIN SA1010 X WITH (NOLOCK) ON X.A1_COD = B.E1_CLIENTE
AND X.A1_LOJA = B.E1_LOJA
AND X.D_E_L_E_T_ = ''
INNER JOIN SF2010 J WITH (NOLOCK) ON J.F2_FILIAL = B.E1_FILORIG
AND J.F2_CLIENTE = B.E1_CLIENTE
AND J.F2_LOJA = B.E1_LOJA
AND J.F2_EMISSAO = B.E1_EMISSAO
AND J.D_E_L_E_T_ = ''
WHERE B.E1_USERLGI <> ' '
AND (
      (CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.E1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.E1_USERLGI, 16, 1)) - 50)) >= REPLACE(CONVERT (date, GETDATE()-7),'-','')
      AND CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.E1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.E1_USERLGI, 16, 1)) - 50)) <= REPLACE(CONVERT (date, GETDATE()),'-',''))
      OR (CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.E1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.E1_USERLGA, 16, 1)) - 50)) >= REPLACE(CONVERT (date, GETDATE()-7),'-','')
      AND CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.E1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.E1_USERLGA, 16, 1)) - 50)) <= REPLACE(CONVERT (date, GETDATE()),'-',''))
      )