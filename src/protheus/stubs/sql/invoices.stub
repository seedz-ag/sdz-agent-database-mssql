SELECT * FROM (
SELECT 
      0 AS TIPOQUERY,
     	(CASE F2_FILIAL
            WHEN '010101' THEN '00000000'
            ELSE NULL
         END) CNPJORIGEMDADOS,
      CONCAT (F2_FILIAL,
            F2_DOC,
            F2_SERIE,
            F2_CLIENTE,
            F2_LOJA,
            F2_EMISSAO,
            F2_CHVNFE,
            F2_IDNF) ID,
      CONCAT (F2_CLIENTE,
            F2_LOJA) IDCLIENTE,
      A1_CGC,
      F2_DOC,
      F2_SERIE,
       CONVERT(VARCHAR(10),CAST(F2_EMISSAO AS DATETIME),121) F2_EMISSAO,
       CONVERT(VARCHAR(10),CAST(F2_DAUTNFE AS DATETIME),121) F2_DAUTNFE,
      (CASE F2_STATUS
            WHEN ' ' THEN 'Concluida'
            WHEN '015' THEN 'Cancelada'
            WHEN '025' THEN 'Pendente'
            ELSE NULL
            END) F2_STATUS,
      F2_CMUNDE,
      F2_UFDEST,
      F2_VALMERC,
      F2_VALBRUT,
      CONCAT (F2_TIPO,
            F2_TIPODOC) TIPOFATURAMENTO,
      B.R_E_C_N_O_,
      B.D_E_L_E_T_ DELETADO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGI, 16, 1)) - 50)), '19960101'), 103) AS DATA_INCLUSAO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGA, 16, 1)) - 50)), '19960101'), 103) AS DATA_ALTERACAO
FROM SF2010 B WITH (NOLOCK)
INNER JOIN SA1010 X WITH (NOLOCK) ON X.A1_COD = B.F2_CLIENTE
AND X.A1_LOJA = B.F2_LOJA
AND X.D_E_L_E_T_ = ''
WHERE (B.F2_USERLGI <> ' '
  AND (
            (1 =1 AND (CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGI, 16, 1)) - 50)), '19960101'), 112) >= {START_DATE})
            )
            OR
            (1 =1 AND (CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGA, 16, 1)) - 50)), '19960101'), 112) >= {START_DATE})
            )
      )
)
UNION ALL
SELECT 
      1 AS TIPOQUERY,
     	(CASE F1_FILIAL
            WHEN '010101' THEN '00000000'
            ELSE NULL
         END) CNPJORIGEMDADOS,
      CONCAT (F1_FILIAL,
            F1_DOC,
            F1_SERIE,
            F1_FORNECE,
            F1_LOJA,
            F1_EMISSAO,
            F1_CHVNFE,
            F1_IDNF) ID,
      CONCAT (F1_FORNECE,
            F1_LOJA) IDCLIENTE,
      A1_CGC,
      F1_DOC,
      F1_SERIE,
      CONVERT(VARCHAR(10),CAST(F1_EMISSAO AS DATETIME),121) F1_EMISSAO,
      CONVERT(VARCHAR(10),CAST(F1_DAUTNFE AS DATETIME),121) F1_DAUTNFE,
      (CASE F1_STATUS
            WHEN ' ' THEN 'Concluida'
            WHEN '015' THEN 'Cancelada'
            WHEN '025' THEN 'Pendente'
            WHEN '030' THEN 'Compra'
            WHEN '026' THEN 'Compra'
            WHEN 'A' THEN 'Concluida'
            ELSE NULL
            END) F1_STATUS,
      NULL F1_CMUNDE,
      NULL F1_UFDEST,
      F1_VALMERC,
      F1_VALBRUT,
      CONCAT(F1_TIPO, F1_TIPODOC) TIPOFATURAMENTO,
      B.R_E_C_N_O_,
      B.D_E_L_E_T_ DELETADO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGI, 16, 1)) - 50)), '19960101'), 103) AS DATA_INCLUSAO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGA, 16, 1)) - 50)), '19960101'), 103) AS DATA_ALTERACAO
FROM SF1010 B WITH (NOLOCK)
INNER JOIN SA1010 X WITH (NOLOCK) ON X.A1_COD = B.F1_FORNECE
AND X.A1_LOJA = B.F1_LOJA
AND X.D_E_L_E_T_ = ''
WHERE (B.F1_USERLGI <> ' '
  AND (
            (1 =1 AND (CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGI, 16, 1)) - 50)), '19960101'), 112) >= {START_DATE})
            )
            OR
            (1 =1 AND (CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGA, 16, 1)) - 50)), '19960101'), 112) >= {START_DATE})
            )
            )
      )
  AND F1_TIPO = 'D'
)
) AS RETORNO