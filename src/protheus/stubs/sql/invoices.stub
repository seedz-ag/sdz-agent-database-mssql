SELECT CASE F2_FILIAL
           WHEN '01' THEN 'CNPJ01'
           ELSE NULL
      END AS CNPJORIGEMDADOS,
      CONCAT (F2_FILIAL,
            F2_DOC,
            F2_SERIE,
            F2_CLIENTE,
            F2_LOJA,
            F2_EMISSAO,
            F2_CHVNFE,
            F2_IDNF) ID,
      CONCAT (F2_CLIENTE,
            F2_LOJA) IDCLIENTE,
      A1_CGC,
      F2_DOC,
      F2_SERIE,
      F2_EMISSAO,
      F2_DAUTNFE,
      (CASE F2_STATUS
            WHEN ' ' THEN 'Concluida'
            WHEN '015' THEN 'Cancelada'
            WHEN '025' THEN 'Pendente'
            ELSE NULL
            END) F2_STATUS,
      F2_CMUNDE,
      F2_UFDEST,
      F2_VALMERC,
      F2_VALBRUT,
      CONCAT (F2_TIPO,
            F2_TIPODOC) TIPOFATURAMENTO,
      B.D_E_L_E_T_ DELETADO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGI, 16, 1)) - 50)), '19960101'), 103) AS DATA_INCLUSAO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGA, 16, 1)) - 50)), '19960101'), 103) AS DATA_ALTERACAO
FROM SF2010 B WITH (NOLOCK)
INNER JOIN SA1010 X WITH (NOLOCK) ON X.A1_COD = B.F2_CLIENTE
AND X.A1_LOJA = B.F2_LOJA
AND X.D_E_L_E_T_ = ''
WHERE B.F2_USERLGI <> ' '
  AND (
            (CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGI, 16, 1)) - 50)), '19960101'), 112) >= REPLACE(CONVERT (date, GETDATE()-7),'-','')
            AND CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGI, 16, 1)) - 50)), '19960101'), 112) <= REPLACE(CONVERT (date, GETDATE()),'-',''))
            OR (CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGA, 16, 1)) - 50)), '19960101'), 112) >= REPLACE(CONVERT (date, GETDATE()-7),'-','')
            AND CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F2_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F2_USERLGA, 16, 1)) - 50)), '19960101'), 112) <= REPLACE(CONVERT (date, GETDATE()),'-',''))
      )
UNION ALL
SELECT 
      CASE F1_FILIAL
            WHEN '01' THEN 'CNPJ01'
            ELSE NULL
      END AS CNPJORIGEMDADOS,
      CONCAT (F1_FILIAL,
            F1_DOC,
            F1_SERIE,
            F1_FORNECE,
            F1_LOJA,
            F1_EMISSAO,
            F1_CHVNFE,
            F1_IDNF) ID,
      CONCAT (F1_FORNECE,
            F1_LOJA) IDCLIENTE,
      A1_CGC,
      F1_DOC,
      F1_SERIE,
      F1_EMISSAO,
      F1_DAUTNFE,
      (CASE F1_STATUS
            WHEN ' ' THEN 'Concluida'
            WHEN '015' THEN 'Cancelada'
            WHEN '025' THEN 'Pendente'
            WHEN '030' THEN 'Compra'
            WHEN '026' THEN 'Compra'
            WHEN 'A' THEN 'ConcluÃ­da'
            ELSE NULL
            END) F1_STATUS,
      NULL F1_CMUNDE,
      NULL F1_UFDEST,
      F1_VALMERC,
      F1_VALBRUT,
      CONCAT(F1_TIPO, F1_TIPODOC) TIPOFATURAMENTO,
      B.D_E_L_E_T_ DELETADO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGI, 16, 1)) - 50)), '19960101'), 103) AS DATA_INCLUSAO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.F1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGA, 16, 1)) - 50)), '19960101'), 103) AS DATA_ALTERACAO
FROM SF1010 B WITH (NOLOCK)
INNER JOIN SA1010 X WITH (NOLOCK) ON X.A1_COD = B.F1_FORNECE
AND X.A1_LOJA = B.F1_LOJA
AND X.D_E_L_E_T_ = ''
WHERE B.F1_USERLGI <> ' '
  AND (
            (CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.F1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGI, 16, 1)) - 50)) >= REPLACE(CONVERT (date, GETDATE()-7),'-','')
            AND CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.F1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGI, 16, 1)) - 50)) <= REPLACE(CONVERT (date, GETDATE()),'-',''))
            OR (CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.F1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGA, 16, 1)) - 50)) >= REPLACE(CONVERT (date, GETDATE()-7),'-','')
            AND CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.F1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.F1_USERLGA, 16, 1)) - 50)) <= REPLACE(CONVERT (date, GETDATE()),'-',''))
      )
  AND F1_TIPO = 'D'