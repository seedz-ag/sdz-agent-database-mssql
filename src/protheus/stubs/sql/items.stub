SELECT 
      B1_FILIAL,
      BM_FILIAL,
      B1_COD,
      B1_CODITE,
      B1_DESC,
      BM_CODMAR,
      B1_UM,
      B1_TIPO,
      B1_PROC,
      B1_ATIVO,
      B1_FABRIC,
      BM_DESC,
      BM_CLASGRU,
      BM_STATUS,
      B1_MODELO,
      B1_DESC_P,
      B1_CODBAR,
      B1_SITPROD,
      B.R_E_C_N_O_,
      B.D_E_L_E_T_ DELETADO_SB1,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.B1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.B1_USERLGI, 16, 1)) - 50)), '19960101'), 101) AS DATA_INCLUSAO,
      CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(B.B1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.B1_USERLGA, 16, 1)) - 50)), '19960101'), 101) AS DATA_ALTERACAO
FROM SB1010 B WITH (NOLOCK)
INNER JOIN SBM010 X WITH (NOLOCK) ON X.BM_GRUPO = B.B1_GRUPO
AND X.D_E_L_E_T_ = ''
WHERE B.B1_USERLGI <> ' '
      AND (CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.B1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.B1_USERLGI, 16, 1)) - 50)) >= '20211101'
      AND CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.B1_USERLGI, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.B1_USERLGI, 16, 1)) - 50)) <= '20211105'
      OR CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.B1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.B1_USERLGA, 16, 1)) - 50)) >= '20211101'
      AND CONVERT(DATETIME, '1996-01-01', 105) + ((ASCII(SUBSTRING(B.B1_USERLGA, 12, 1)) - 50) * 100 + (ASCII(SUBSTRING(B.B1_USERLGA, 16, 1)) - 50)) <= '20211105')